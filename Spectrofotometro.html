<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="J. Andres Castiilo">

<title>Espectrofotometro_data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Spectrofotometro_files/libs/clipboard/clipboard.min.js"></script>
<script src="Spectrofotometro_files/libs/quarto-html/quarto.js"></script>
<script src="Spectrofotometro_files/libs/quarto-html/popper.min.js"></script>
<script src="Spectrofotometro_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Spectrofotometro_files/libs/quarto-html/anchor.min.js"></script>
<link href="Spectrofotometro_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Spectrofotometro_files/libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Spectrofotometro_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Spectrofotometro_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Spectrofotometro_files/libs/bootstrap/bootstrap-afb7ef7cec2bb82ae451d0cdffc16375.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Espectrofotometro_data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>J. Andres Castiilo </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="analisis-de-espectofotometro-con-oro-de-celulas-hepg2" class="level1">
<h1>Analisis de Espectofotometro con ORO de celulas HEPG2</h1>
<section id="library" class="level2">
<h2 class="anchored" data-anchor-id="library">Library</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome to emmeans.
Caution: You lose important information if you filter this package's results.
See '? untidy'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Frame Tratamientos</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">Absorbancia =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">500</span>, <span class="dv">500</span>,<span class="dv">500</span>,<span class="dv">500</span>,<span class="dv">500</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">T_0mM =</span> <span class="fu">c</span>(<span class="fl">0.183</span>, <span class="fl">0.18</span>,<span class="fl">0.178</span>,<span class="fl">0.177</span>,<span class="fl">0.171</span>,<span class="fl">0.172</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">T_0.5mM =</span> <span class="fu">c</span>(<span class="fl">0.311</span>, <span class="fl">0.322</span>, <span class="fl">0.314</span>, <span class="fl">0.344</span>, <span class="fl">0.327</span>,<span class="fl">0.325</span>),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">T_1mM =</span> <span class="fu">c</span>(<span class="fl">0.363</span>, <span class="fl">0.385</span>, <span class="fl">0.372</span>, <span class="fl">0.364</span>, <span class="fl">0.406</span>, <span class="fl">0.393</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">Control =</span> <span class="fu">c</span>(<span class="fl">0.045</span>,<span class="fl">0.049</span>,<span class="fl">0.048</span>,<span class="fl">0.047</span>,<span class="fl">0.046</span>, <span class="fl">0.044</span>))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Absorbancia T_0mM T_0.5mM T_1mM Control
1         500 0.183   0.311 0.363   0.045
2         500 0.180   0.322 0.385   0.049
3         500 0.178   0.314 0.372   0.048
4         500 0.177   0.344 0.364   0.047
5         500 0.171   0.327 0.406   0.046
6         500 0.172   0.325 0.393   0.044</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Absorbancia      T_0mM           T_0.5mM           T_1mM       
 Min.   :500   Min.   :0.1710   Min.   :0.3110   Min.   :0.3630  
 1st Qu.:500   1st Qu.:0.1732   1st Qu.:0.3160   1st Qu.:0.3660  
 Median :500   Median :0.1775   Median :0.3235   Median :0.3785  
 Mean   :500   Mean   :0.1768   Mean   :0.3238   Mean   :0.3805  
 3rd Qu.:500   3rd Qu.:0.1795   3rd Qu.:0.3265   3rd Qu.:0.3910  
 Max.   :500   Max.   :0.1830   Max.   :0.3440   Max.   :0.4060  
    Control       
 Min.   :0.04400  
 1st Qu.:0.04525  
 Median :0.04650  
 Mean   :0.04650  
 3rd Qu.:0.04775  
 Max.   :0.04900  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">condicion =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"0mM"</span>, <span class="st">"0.5mM"</span>,<span class="st">"1mM"</span>,<span class="st">"Blanco"</span>), <span class="at">each =</span> <span class="dv">6</span> ),  <span class="co"># 6 réplicas por tratamiento (3 por muestra)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">muestra =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Muestra_1"</span>, <span class="st">"Muestra_2"</span>,<span class="st">"Muestra_3"</span>,<span class="st">"Muestra_4"</span>,<span class="st">"Muestra_5"</span>,<span class="st">"Muestra_6"</span>, <span class="st">"BLANCO"</span>,<span class="st">"BLANCO"</span>), <span class="at">each =</span> <span class="dv">3</span>),  <span class="co"># Cada muestra tiene 3 réplicas</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">replica =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">times =</span> <span class="dv">8</span>),  <span class="co"># Número de réplica</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">absorbancia =</span> <span class="fu">c</span>(<span class="fl">0.183</span>, <span class="fl">0.18</span>,<span class="fl">0.178</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fl">0.177</span>,<span class="fl">0.171</span>,<span class="fl">0.172</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                  <span class="fl">0.311</span>, <span class="fl">0.322</span>, <span class="fl">0.314</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                  <span class="fl">0.344</span>, <span class="fl">0.327</span>,<span class="fl">0.325</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                  <span class="fl">0.363</span>, <span class="fl">0.385</span>, <span class="fl">0.372</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fl">0.364</span>, <span class="fl">0.406</span>, <span class="fl">0.393</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                  <span class="fl">0.045</span>,<span class="fl">0.049</span>,<span class="fl">0.048</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fl">0.047</span>,<span class="fl">0.046</span>, <span class="fl">0.044</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Ver la tabla</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   condicion   muestra replica absorbancia
1        0mM Muestra_1       1       0.183
2        0mM Muestra_1       2       0.180
3        0mM Muestra_1       3       0.178
4        0mM Muestra_2       1       0.177
5        0mM Muestra_2       2       0.171
6        0mM Muestra_2       3       0.172
7      0.5mM Muestra_3       1       0.311
8      0.5mM Muestra_3       2       0.322
9      0.5mM Muestra_3       3       0.314
10     0.5mM Muestra_4       1       0.344
11     0.5mM Muestra_4       2       0.327
12     0.5mM Muestra_4       3       0.325
13       1mM Muestra_5       1       0.363
14       1mM Muestra_5       2       0.385
15       1mM Muestra_5       3       0.372
16       1mM Muestra_6       1       0.364
17       1mM Muestra_6       2       0.406
18       1mM Muestra_6       3       0.393
19    Blanco    BLANCO       1       0.045
20    Blanco    BLANCO       2       0.049
21    Blanco    BLANCO       3       0.048
22    Blanco    BLANCO       1       0.047
23    Blanco    BLANCO       2       0.046
24    Blanco    BLANCO       3       0.044</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  condicion   muestra replica absorbancia
1       0mM Muestra_1       1       0.183
2       0mM Muestra_1       2       0.180
3       0mM Muestra_1       3       0.178
4       0mM Muestra_2       1       0.177
5       0mM Muestra_2       2       0.171
6       0mM Muestra_2       3       0.172</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(datos,<span class="st">"/home/joshoacr13/Documentos/TFM/mirna_analysis/input/datos_ORO.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular la media y desviación estándar por condición</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>resumen <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condicion) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">media_absorbancia =</span> <span class="fu">mean</span>(absorbancia),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_absorbancia =</span> <span class="fu">sd</span>(absorbancia)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resumen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  condicion media_absorbancia sd_absorbancia
  &lt;chr&gt;                 &lt;dbl&gt;          &lt;dbl&gt;
1 0.5mM                0.324         0.0117 
2 0mM                  0.177         0.00462
3 1mM                  0.380         0.0172 
4 Blanco               0.0465        0.00187</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> condicion, <span class="at">y =</span> absorbancia, <span class="at">color =</span> muestra)) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="dv">0</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">group =</span> muestra), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Absorbancia por condición y muestra"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Condición"</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Absorbancia"</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_line()`: Each group consists of only one observation.
ℹ Do you need to adjust the group aesthetic?</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Spectrofotometro_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparaciones estadísticas: ANOVA</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(absorbancia <span class="sc">~</span> condicion <span class="sc">*</span> muestra, <span class="at">data =</span> datos)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq  F value Pr(&gt;F)    
condicion    3 0.4076 0.13588 1537.052 &lt;2e-16 ***
muestra      3 0.0008 0.00026    2.948 0.0624 .  
Residuals   17 0.0015 0.00009                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruebas post-hoc para comparar condiciones (independientemente de la muestra)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>posthoc_condicion <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(anova, pairwise <span class="sc">~</span> condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: A nesting structure was detected in the fitted model:
    muestra %in% condicion</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(posthoc_condicion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 condicion emmean      SE df lower.CL upper.CL
 0.5mM     0.3238 0.00384 17   0.3157   0.3319
 0mM       0.1768 0.00384 17   0.1687   0.1849
 1mM       0.3805 0.00384 17   0.3724   0.3886
 Blanco    0.0465 0.00384 17   0.0384   0.0546

Results are averaged over the levels of: muestra 
Confidence level used: 0.95 

$contrasts
 contrast       estimate      SE df t.ratio p.value
 0.5mM - 0mM      0.1470 0.00543 17  27.080  &lt;.0001
 0.5mM - 1mM     -0.0567 0.00543 17 -10.439  &lt;.0001
 0.5mM - Blanco   0.2773 0.00543 17  51.090  &lt;.0001
 0mM - 1mM       -0.2037 0.00543 17 -37.519  &lt;.0001
 0mM - Blanco     0.1303 0.00543 17  24.010  &lt;.0001
 1mM - Blanco     0.3340 0.00543 17  61.528  &lt;.0001

Results are averaged over the levels of: muestra 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruebas post-hoc para comparar muestras (independientemente de la condición)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>posthoc_muestra <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(anova, pairwise <span class="sc">~</span> muestra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: A nesting structure was detected in the fitted model:
    muestra %in% condicion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(posthoc_muestra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 muestra   condicion emmean      SE df lower.CL upper.CL
 Muestra_3 0.5mM     0.3157 0.00543 17   0.3042   0.3271
 Muestra_4 0.5mM     0.3320 0.00543 17   0.3205   0.3435
 Muestra_1 0mM       0.1803 0.00543 17   0.1689   0.1918
 Muestra_2 0mM       0.1733 0.00543 17   0.1619   0.1848
 Muestra_5 1mM       0.3733 0.00543 17   0.3619   0.3848
 Muestra_6 1mM       0.3877 0.00543 17   0.3762   0.3991
 BLANCO    Blanco    0.0465 0.00384 17   0.0384   0.0546

Confidence level used: 0.95 

$contrasts
 contrast                          estimate      SE df t.ratio p.value
 Muestra_3 0.5mM - Muestra_4 0.5mM  -0.0163 0.00768 17  -2.128  0.3808
 Muestra_3 0.5mM - Muestra_1 0mM     0.1353 0.00768 17  17.629  &lt;.0001
 Muestra_3 0.5mM - Muestra_2 0mM     0.1423 0.00768 17  18.540  &lt;.0001
 Muestra_3 0.5mM - Muestra_5 1mM    -0.0577 0.00768 17  -7.512  &lt;.0001
 Muestra_3 0.5mM - Muestra_6 1mM    -0.0720 0.00768 17  -9.379  &lt;.0001
 Muestra_3 0.5mM - BLANCO Blanco     0.2692 0.00665 17  40.486  &lt;.0001
 Muestra_4 0.5mM - Muestra_1 0mM     0.1517 0.00768 17  19.756  &lt;.0001
 Muestra_4 0.5mM - Muestra_2 0mM     0.1587 0.00768 17  20.668  &lt;.0001
 Muestra_4 0.5mM - Muestra_5 1mM    -0.0413 0.00768 17  -5.384  0.0008
 Muestra_4 0.5mM - Muestra_6 1mM    -0.0557 0.00768 17  -7.251  &lt;.0001
 Muestra_4 0.5mM - BLANCO Blanco     0.2855 0.00665 17  42.943  &lt;.0001
 Muestra_1 0mM - Muestra_2 0mM       0.0070 0.00768 17   0.912  0.9655
 Muestra_1 0mM - Muestra_5 1mM      -0.1930 0.00768 17 -25.140  &lt;.0001
 Muestra_1 0mM - Muestra_6 1mM      -0.2073 0.00768 17 -27.007  &lt;.0001
 Muestra_1 0mM - BLANCO Blanco       0.1338 0.00665 17  20.130  &lt;.0001
 Muestra_2 0mM - Muestra_5 1mM      -0.2000 0.00768 17 -26.052  &lt;.0001
 Muestra_2 0mM - Muestra_6 1mM      -0.2143 0.00768 17 -27.919  &lt;.0001
 Muestra_2 0mM - BLANCO Blanco       0.1268 0.00665 17  19.077  &lt;.0001
 Muestra_5 1mM - Muestra_6 1mM      -0.0143 0.00768 17  -1.867  0.5254
 Muestra_5 1mM - BLANCO Blanco       0.3268 0.00665 17  49.160  &lt;.0001
 Muestra_6 1mM - BLANCO Blanco       0.3412 0.00665 17  51.316  &lt;.0001

P value adjustment: tukey method for comparing a family of 7 estimates </code></pre>
</div>
</div>
</section>
<section id="la-ley-de-lambert-beer-es-fundamental-en-espectroscopía-y-química-analítica-y-establece-que" class="level2">
<h2 class="anchored" data-anchor-id="la-ley-de-lambert-beer-es-fundamental-en-espectroscopía-y-química-analítica-y-establece-que">La Ley de Lambert-Beer es fundamental en espectroscopía y química analítica, y establece que:</h2>
<p>[ A = c l ]</p>
<p>Donde: - (A): Absorbancia medida (sin unidad). - (): Coeficiente de absorción molar (L·mol(<sup>{-1})·cm(</sup>{-1})), una constante que depende de la sustancia y la longitud de onda. - (c): Concentración de la sustancia en la muestra (mol·L(^{-1})). - (l): Longitud del trayecto óptico o de la celda (cm), típicamente es 1 cm.</p>
<section id="en-qué-contexto-puedes-aplicar-la-ley-de-lambert-beer" class="level3">
<h3 class="anchored" data-anchor-id="en-qué-contexto-puedes-aplicar-la-ley-de-lambert-beer"><strong>¿En qué contexto puedes aplicar la Ley de Lambert-Beer?</strong></h3>
<ol type="1">
<li><p><strong>Determinación de concentración</strong>: Si conoces el coeficiente de absorción molar (()) y la longitud del trayecto óptico ((l)), puedes usar la absorbancia medida ((A)) para calcular la concentración ((c)) de una sustancia desconocida.</p>
<p>Ejemplo:</p>
<ul>
<li>Si estás analizando la concentración de oro en una solución después de una tinción, puedes medir la absorbancia y, usando el coeficiente (), determinar cuánto oro está presente.</li>
</ul></li>
<li><p><strong>Verificación de linealidad</strong>: La Ley de Lambert-Beer es válida en un rango lineal de concentraciones. Si trazas un gráfico de (A) vs.&nbsp;(c), debe ser una línea recta. Esto te ayuda a:</p>
<ul>
<li>Comprobar si tu sistema experimental está en el rango válido.</li>
<li>Determinar () (pendiente de la gráfica si (l = 1)).</li>
</ul></li>
<li><p><strong>Evaluación de la pureza o composición de una muestra</strong>: Comparando la absorbancia medida con valores esperados para sustancias puras, puedes detectar impurezas o variaciones en las propiedades ópticas.</p></li>
</ol>
</section>
<section id="qué-buscarías-analizar-usando-esta-ley" class="level3">
<h3 class="anchored" data-anchor-id="qué-buscarías-analizar-usando-esta-ley"><strong>¿Qué buscarías analizar usando esta ley?</strong></h3>
<ul>
<li><p><strong>Concentración de un compuesto</strong>: En muestras complejas, puedes analizar la cantidad de un compuesto específico que absorbe a una longitud de onda determinada. Ejemplo: Determinar la cantidad de oro en una solución coloreada usando absorbancia a 450 nm.</p></li>
<li><p><strong>Eficiencia de tinción</strong>: Si estás utilizando una tinción basada en oro (como para biomarcadores), la absorbancia te indicará qué tan eficiente fue la tinción.</p></li>
<li><p><strong>Características ópticas del compuesto</strong>: Determinar el coeficiente de absorción molar (()) para una sustancia nueva o bajo condiciones particulares.</p></li>
<li><p><strong>Estudios cinéticos</strong>: Si mides la absorbancia en función del tiempo, puedes estudiar reacciones químicas que cambien la concentración de sustancias absorbentes.</p></li>
</ul>
</section>
<section id="ejemplo-práctico" class="level3">
<h3 class="anchored" data-anchor-id="ejemplo-práctico"><strong>Ejemplo práctico</strong></h3>
<p>Si deseas calcular concentraciones usando tus datos de absorbancia, asegúrate de tener: 1. <strong>El valor de (</strong>) para tu compuesto a la longitud de onda de medición. 2. La longitud del trayecto óptico ((l)), generalmente proporcionada por el fabricante de la cubeta.</p>
<section id="fórmula-para-concentración" class="level4">
<h4 class="anchored" data-anchor-id="fórmula-para-concentración">Fórmula para concentración:</h4>
<p>[ c = ]</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros experimentales</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="dv">18000</span>  <span class="co"># Coeficiente de absorción molar en L·mol^-1·cm^-1 (ajusta según tu compuesto)</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">1</span>           <span class="co"># Longitud del trayecto óptico en cm (usualmente 1 cm)</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">408.5</span> <span class="co"># g/mol</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular concentraciones usando la Ley de Lambert-Beer</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">concentracion_mol_L =</span> absorbancia <span class="sc">/</span> (epsilon <span class="sc">*</span> l)) <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">concentracion_ug_mL =</span> concentracion_mol_L <span class="sc">*</span> M <span class="sc">*</span> (<span class="dv">10</span><span class="sc">**</span><span class="dv">6</span>))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar los resultados</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  condicion   muestra replica absorbancia concentracion_mol_L
1       0mM Muestra_1       1       0.183        1.016667e-05
2       0mM Muestra_1       2       0.180        1.000000e-05
3       0mM Muestra_1       3       0.178        9.888889e-06
4       0mM Muestra_2       1       0.177        9.833333e-06
5       0mM Muestra_2       2       0.171        9.500000e-06
6       0mM Muestra_2       3       0.172        9.555556e-06
  concentracion_ug_mL
1            4153.083
2            4085.000
3            4039.611
4            4016.917
5            3880.750
6            3903.444</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumir las concentraciones promedio por condición y muestra</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>resumen_concentraciones <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condicion, muestra) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">concentracion_media =</span> <span class="fu">mean</span>(concentracion_ug_mL),</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">concentracion_sd =</span> <span class="fu">sd</span>(concentracion_ug_mL),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el resumen</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resumen_concentraciones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 5
  condicion muestra   concentracion_media concentracion_sd     n
  &lt;chr&gt;     &lt;chr&gt;                   &lt;dbl&gt;            &lt;dbl&gt; &lt;int&gt;
1 0.5mM     Muestra_3               7164.            129.      3
2 0.5mM     Muestra_4               7535.            237.      3
3 0mM       Muestra_1               4093.             57.1     3
4 0mM       Muestra_2               3934.             73.0     3
5 1mM       Muestra_5               8473.            251.      3
6 1mM       Muestra_6               8798.            488.      3
7 Blanco    BLANCO                  1055.             42.5     6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar absorbancia y concentraciones</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de absorbancia</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> condicion, <span class="at">y =</span> absorbancia, <span class="at">color =</span> muestra)) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Absorbancia por condición"</span>, <span class="at">x =</span> <span class="st">"Condición"</span>, <span class="at">y =</span> <span class="st">"Absorbancia"</span>) <span class="sc">+</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Spectrofotometro_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de concentración</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> condicion, <span class="at">y =</span> concentracion_ug_mL, <span class="at">color =</span> muestra)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Concentración por condición (Ley de Lambert-Beer)"</span>, <span class="at">x =</span> <span class="st">"Condición"</span>, <span class="at">y =</span> <span class="st">"Concentración (mol/L)"</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Spectrofotometro_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>